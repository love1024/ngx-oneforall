import{Nc as O,Rc as b,T as u,V as p,Vb as o,Wc as _,X as e,ea as y,ha as g,hc as m,pa as f,sc as v,w as d}from"./chunk-4VR2QSN3.js";import{a as l}from"./chunk-DV6QXP24.js";var c={maxSize:50},h=new p("HISTORY_CONFIG");function R(i){return[s,{provide:h,useValue:i??c}]}var s=class i{router=e(_);location=e(m);destroyRef=e(y);isBrowser=v(e(f));config=e(h,{optional:!0});maxSize;_history=g([]);isTracking=!1;constructor(){let r=l(l({},c),this.config);this.maxSize=r.maxSize}history=this._history.asReadonly();currentUrl=o(()=>{let r=this._history();return r.length>0?r[r.length-1]:null});previousUrl=o(()=>{let r=this._history();return r.length>1?r[r.length-2]:null});canGoBack=o(()=>this._history().length>1);length=o(()=>this._history().length);back(){this.canGoBack()&&this.location.back()}backOrFallback(r){this.canGoBack()?this.location.back():this.router.navigateByUrl(r)}forward(){this.location.forward()}replaceCurrent(r){return this.router.navigateByUrl(r,{replaceUrl:!0})}clear(){this._history.set([])}getHistory(){return[...this._history()]}startTracking(){if(this.isTracking||!this.isBrowser)return;this.isTracking=!0;let r=this.router.url;r&&this._history.set([r]),this.router.events.pipe(d(t=>t instanceof b),O(this.destroyRef)).subscribe(t=>{this._history.update(n=>{if(n[n.length-1]===t.urlAfterRedirects)return n;let a=[...n,t.urlAfterRedirects];return a.length>this.maxSize?a.slice(-this.maxSize):a})})}static \u0275fac=function(t){return new(t||i)};static \u0275prov=u({token:i,factory:i.\u0275fac})};export{s as a,R as b};
